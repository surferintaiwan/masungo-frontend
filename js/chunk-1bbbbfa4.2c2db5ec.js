(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1bbbbfa4"],{"644d":function(t,e,r){"use strict";var a=r("2fa3");e["a"]={getCartItems:function(t){var e=t.cartId;return a["b"].get("/cart/".concat(e))},addCartItem:function(t){var e=t.cartId,r=t.productId,n=t.amount;return a["b"].post("/cart",{cartId:e,productId:r,amount:n})},deleteCartItem:function(t){var e=t.cartId,r=t.productId;return a["b"].delete("/cart",{params:{cartId:e,productId:r}})}}},9943:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container py-5"},[r("p",[t.categories.category1?r("span",{staticClass:"text-info"},[t._v(t._s(t.categories.category1.name))]):t._e(),t.categories.category2?r("span",{staticClass:"text-info"},[t._v("> "+t._s(t.categories.category2.name))]):t._e(),t.categories.category3?r("span",{staticClass:"text-info"},[t._v("> "+t._s(t.categories.category3.name))]):t._e()]),r("div",{staticClass:"container"},[r("div",{staticClass:"row justify-content-between"},[r("select",{attrs:{name:"brand"},on:{change:function(e){return t.chooseBrand(e)}}},[r("option",{attrs:{value:"",selected:""}},[t._v("全部")]),t._v("> "),t._l(t.brands,(function(e){return r("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))])}))],2),r("select",{attrs:{name:"sort"},on:{change:function(e){return t.chooseSort(e)}}},[r("option",{attrs:{disabled:"",value:"",selected:""}},[t._v("請選擇排序方式")]),t._v("> "),r("option",{attrs:{value:"sellingPriceDESC"}},[t._v("售價:高->低")]),r("option",{attrs:{value:"sellingPriceASC"}},[t._v("售價:低->高")]),r("option",{attrs:{value:"createdAtDESC"}},[t._v("最新商品在前")]),r("option",{attrs:{value:"createdAtASC"}},[t._v("最新商品在後")])])])]),r("div",{staticClass:"row mt-2"},t._l(t.products,(function(e){return r("div",{key:e.id,staticClass:"col-3"},[r("div",{staticClass:"card"},[r("img",{staticClass:"card-img-top",attrs:{src:e.image1,alt:""}}),r("div",{staticClass:"card-body"},[r("router-link",{attrs:{to:{name:"product-detail",params:{productId:e.id}}}},[r("h5",{staticClass:"card-title"},[t._v(t._s(e.name))])]),r("p",[t._v("NT. "+t._s(e.sellingPrice))]),r("div",{staticClass:"row"},[e.isFollowed?r("button",{staticClass:"btn btn-danger ml-2",attrs:{type:"submit"},on:{click:function(r){return t.deleteFollowing(e.id)}}},[t._v("取消追蹤")]):r("button",{staticClass:"btn btn-info ml-2",attrs:{type:"submit"},on:{click:function(r){return t.addFollowing(e.id)}}},[t._v("+追蹤")]),r("button",{staticClass:"btn btn-warning ml-2",attrs:{type:"submit"},on:{click:function(r){return t.addCartItem(e.id)}}},[t._v("+購物車")])])],1)])])})),0)])},n=[],c=(r("d81d"),r("5530")),o=(r("96cf"),r("1da1")),s=r("ee21"),i=r("644d"),u=r("4cce"),d=r("2fa3"),l={data:function(){return{products:[],brands:[],categories:{}}},created:function(){this.getProductsByCategory(this.$route.query),this.getAllBrands(this.$route.query)},methods:{getProductsByCategory:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var a,n,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,s["a"].getProductsByCategory(t);case 3:if(a=r.sent,n=a.data,c=a.statusText,e.products=n.products,"OK"===c){r.next=8;break}throw new Error(c);case 8:console.log(n),e.categories=n.categories,r.next=15;break;case 12:r.prev=12,r.t0=r["catch"](0),console.log(r.t0);case 15:case"end":return r.stop()}}),r,null,[[0,12]])})))()},getAllBrands:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var a,n,c,o,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,a="",n=null,t.category1Id?(a="category1",n=t.category1Id):t.category2Id?(a="category2",n=t.category2Id):t.category3Id&&(a="category3",n=t.category3Id),r.next=6,s["a"].getAllBrands({whichCategory:a,categoryId:n});case 6:if(c=r.sent,o=c.data,i=c.statusText,"OK"===i){r.next=10;break}throw new Error(i);case 10:e.brands=o.brands,r.next=16;break;case 13:r.prev=13,r.t0=r["catch"](0),d["a"].fire({icon:"error",title:"無法獲取該類別品牌資料"});case 16:case"end":return r.stop()}}),r,null,[[0,13]])})))()},chooseBrand:function(t){var e=Object(c["a"])({},this.$route.query);e["brandId"]=t.target.value,this.$router.push({name:"products-by-category",query:e})},chooseSort:function(t){var e=Object(c["a"])({},this.$route.query);e["sort"]=t.target.value,this.$router.push({name:"products-by-category",query:e})},addCartItem:function(t){return Object(o["a"])(regeneratorRuntime.mark((function e(){var r,a,n,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,r=localStorage.getItem("cartId"),e.next=4,i["a"].addCartItem({cartId:r,productId:t,amount:1});case 4:if(a=e.sent,n=a.data,c=a.statusText,"OK"===c){e.next=8;break}throw new Error(c);case 8:localStorage.setItem("cartId",n.cartId),d["a"].fire({type:"success",title:"已將本商品加入購物車"}),e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](0),d["a"].fire({icon:"error",title:"無法加入購物車"}),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})))()},addFollowing:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var a,n,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,u["a"].addFollowingProduct({productId:t});case 3:if(a=r.sent,n=a.data,o=a.statusText,"OK"===o&&"success"===n.status){r.next=7;break}throw new Error(o);case 7:e.products=e.products.map((function(e){return e.id===t?Object(c["a"])({},e,{isFollowed:!0}):e})),d["a"].fire({icon:"success",title:"追蹤成功"}),r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](0),console.log(r.t0),d["a"].fire({icon:"error",title:"無法加入追蹤清單"});case 15:case"end":return r.stop()}}),r,null,[[0,11]])})))()},deleteFollowing:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var a,n,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,u["a"].deleteFollowingProduct({productId:t});case 3:if(a=r.sent,n=a.data,o=a.statusText,"OK"===o&&"success"===n.status){r.next=7;break}throw new Error(o);case 7:e.products=e.products.map((function(e){return e.id===t?Object(c["a"])({},e,{isFollowed:!1}):e})),d["a"].fire({icon:"success",title:"移除追蹤成功"}),r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](0),console.log(r.t0),d["a"].fire({icon:"error",title:"無法將商品自追蹤清單移除"});case 15:case"end":return r.stop()}}),r,null,[[0,11]])})))()}},beforeRouteUpdate:function(t,e,r){this.getProductsByCategory(t.query),this.getAllBrands(t.query),r()}},p=l,g=r("2877"),v=Object(g["a"])(p,a,n,!1,null,null,null);e["default"]=v.exports},d81d:function(t,e,r){"use strict";var a=r("23e7"),n=r("b727").map,c=r("1dde"),o=r("ae40"),s=c("map"),i=o("map");a({target:"Array",proto:!0,forced:!s||!i},{map:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-1bbbbfa4.2c2db5ec.js.map